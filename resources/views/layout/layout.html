<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Callejón 9{% endblock %} - Sistema de Restaurante</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; }
        
        /* Animaciones suaves */
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Sidebar activo */
        .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 flex min-h-screen">

    <!-- Sidebar -->
    <aside class="w-64 bg-white border-r border-gray-200 shadow-lg flex flex-col">
        <!-- Logo -->
        <div class="h-20 flex items-center justify-center border-b border-gray-200">
            <img src="{{ url_for('static', filename='img/Logo2.png') }}" alt="Callejón 9" class="h-12">
        </div>
        
        <!-- Perfil del Usuario -->
        <div class="px-6 py-4 border-b border-gray-200 text-center">
            {% if session['usuario_foto'] %}
                <img src="{{ url_for('static', filename='images/perfiles/' ~ session['usuario_foto']) }}" 
                     alt="Foto" class="w-16 h-16 rounded-full mx-auto mb-2 shadow-md object-cover">
            {% else %}
                <div class="w-16 h-16 rounded-full mx-auto mb-2 bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-2xl font-bold shadow-md">
                    {{ session['usuario_nombre'][0] }}{{ session['usuario_apellidos'][0] }}
                </div>
            {% endif %}
            
            <p class="font-semibold text-gray-900">{{ session['usuario_nombre'] }} {{ session['usuario_apellidos'] }}</p>
            <p class="text-sm text-gray-500">{{ rol_nombre }}</p>
        </div>

        <!-- Navegación -->
        <nav class="flex-1 px-4 py-6 space-y-2 text-sm">
            {% block navigation %}
            <!-- Cada rol tendrá su propia navegación -->
            {% endblock %}
        </nav>

        <!-- Botón de Cerrar Sesión -->
        <div class="p-4 mt-auto border-t border-gray-200">
            <a href="{{ url_for('routes.logout') }}"
               class="flex items-center justify-center gap-2 w-full bg-red-50 text-red-600 px-4 py-3 rounded-lg hover:bg-red-100 transition font-medium">
                <i class="bi bi-door-open"></i>
                <span>Cerrar sesión</span>
            </a>
        </div>
    </aside>

    <!-- Contenido Principal -->
    <main class="flex-1 flex flex-col overflow-hidden">
        <!-- Header -->
        <header class="bg-white border-b border-gray-200 px-8 py-4 flex items-center justify-between">
            <div>
                <h1 class="text-2xl font-bold text-gray-900">{% block page_title %}Dashboard{% endblock %}</h1>
                <p class="text-sm text-gray-500">{% block page_subtitle %}Bienvenido al sistema{% endblock %}</p>
            </div>
            
            <div class="flex items-center gap-4">
                <!-- Tema -->
                <button onclick="toggleTheme()" class="p-2 rounded-lg hover:bg-gray-100 transition">
                    <i class="bi bi-moon text-gray-600 text-xl"></i>
                </button>
                
                <!-- Notificaciones -->
                <button class="relative p-2 rounded-lg hover:bg-gray-100 transition">
                    <i class="bi bi-bell text-gray-600 text-xl"></i>
                    <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
                </button>
            </div>
        </header>

        <!-- Contenido de la Página -->
        <div class="flex-1 overflow-y-auto p-8 fade-in">
            {% block content %}
            <!-- Contenido específico de cada página -->
            {% endblock %}
        </div>
    </main>

    <script>
        function toggleTheme() {
            fetch("{{ url_for('routes.toggle_theme') }}", {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' }
            }).then(() => location.reload());
        }
    </script>
    
    {% block scripts %}{% endblock %}
</body>
</html>